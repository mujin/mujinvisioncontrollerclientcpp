info:
  description: The API of the Mujin vision client. Used for client generation.
include:
- mujinrepo:mujinvisionmanager.schema.visionTaskParametersSchema
- mujinrepo:mujinvisionmanager.schema.sensorSelectionInfosSchema
- mujinrepo:mujinvisionmanager.schema.detectionParametersSchema
- mujinrepo:mujinvisionmanager.schema.pointCloudFilteringParametersSchema
- components.yaml
mujinapi: 0.0.1
services:
  # GetPublishedState: {}  # Subscription
  GetPublishedStateService:  # Config
    x-usesConfigSocket: true
  Ping:  # Config
    x-usesConfigSocket: true
  SetLogLevel:  # Config
    description: Sets the log level for the visionmanager.
    x-usesConfigSocket: true
    parameters:
      componentLevels:
        required: true
        type: object
        description: A dictionary of component names and their respective log levels.
  Cancel:
    description: Cancels the current command.
    x-usesConfigSocket: true
    parameters: {}
  Quit:
    description: Quits the visionmanager.
    x-usesConfigSocket: true
    parameters: {}
  GetTaskStateService:
    description: Gets the task state of the visionmanager.
    x-usesConfigSocket: true
    parameters: {}
  GetVisionStatistics:
    description: Gets the latest vision stats.
    parameters:
      cycleIndex:
        $merge: '#/mujinvisionmanager.schema.detectionParametersSchema/detectionParametersSchema.properties.cycleIndex'
      taskId:
        type: string
        description: If specified, the taskId to retrieve the detected objects from.
      taskType:
        $merge: "#/components/taskType"
  GetStatusPort:
    description: Gets the status port of the visionmanager.
    parameters: {}
  GetConfigPort:
    description: Gets the config port of the visionmanager.
    parameters: {}
  GetLatestDetectedObjects:
    description: Gets the latest detected objects.
    parameters:
      cycleIndex:
        $merge: '#/mujinvisionmanager.schema.detectionParametersSchema/detectionParametersSchema.properties.cycleIndex'
      taskId:
        type: string
        description: If specified, the taskId to retrieve the detected objects from.
      taskType:
        $merge: "#/components/taskType"
  GetLatestDetectionResultImages:
    description: Gets the latest detected result images.
    parameters:
      newerthantimestamp:
        type: bool
        description: If specified, starttimestamp of the image must be newer than this value in milliseconds.
      metadataOnly:
        type: bool
        description: 'Default: False'
      sensorSelectionInfos:
        $merge: '#/components/sensorSelectionInfos'
      taskId:
        type: string
        description: If specified, the taskId to retrieve the detected objects from.
      taskType:
        $merge: "#/components/taskType"
      cycleIndex:
        $merge: '#/mujinvisionmanager.schema.detectionParametersSchema/detectionParametersSchema.properties.cycleIndex'
  GetDetectionHistory:
    description: Gets detection result with given timestamp (sensor time)
    parameters:
      timestamp:
        required: true
        type: integer
        description: unix timestamp in milliseconds
  StopTask:
    description: Stops a set of tasks that meet the filter criteria
    parameters:
      taskTypes:
        type: array
        description: If specified, a list of task types to stop
        items:
          $merge: "#/components/taskType"
      waitForStop:
        type: bool
        description: If True, then wait for task to stop, otherwise just trigger it to stop, but do not wait
      removeTask:
        type: bool
        description: If True, then remove the task from being tracked by the vision manager and destroy all its resources. Will wait for the task to end before returning.
      taskId:
        type: string
        description: If specified, the specific taskId to stop
      taskType:
        $merge: "#/components/taskType"
      cycleIndex:
        $merge: '#/mujinvisionmanager.schema.detectionParametersSchema/detectionParametersSchema.properties.cycleIndex'
  ResumeTask:
    description: Resumes a set of tasks that meet the filter criteria
    parameters:
      taskTypes:
        type: array
        description: If specified, a list of task types to resume
        items:
          $merge: "#/components/taskType"
      waitForStop:
        type: bool
        description: DEPRECATED. This is unused.
      taskId:
        type: string
        description: If specified, the specific taskId to resume
      taskType:
        $merge: "#/components/taskType"
      cycleIndex:
        $merge: '#/mujinvisionmanager.schema.detectionParametersSchema/detectionParametersSchema.properties.cycleIndex'
  StartObjectDetectionTask:
    returns: {}
    description: Starts detection thread to continuously detect objects. the vision server will send detection results directly to mujin controller.
    parameters:
      systemState:
        $merge: '#/controllercommon.schema.profileMapSchema/profileSelectorSchema'
  StartContainerDetectionTask:
    returns: {}
    description: Starts container detection thread to continuously detect a container. the vision server will send detection results directly to mujin controller.
    parameters:
      systemState:
        $merge: '#/controllercommon.schema.profileMapSchema/profileSelectorSchema'
  StartVisualizePointCloudTask:
    description: Start point cloud visualization thread to sync camera info from the mujin controller and send the raw camera point clouds to mujin controller
    parameters:
      systemState:
        $merge: '#/controllercommon.schema.profileMapSchema/profileSelectorSchema'
  BackupVisionLog:
    description: Backs up the vision log for a given cycle index
    parameters:
      cycleIndex:
        required: true
        $merge: '#/mujinvisionmanager.schema.detectionParametersSchema/detectionParametersSchema.properties.cycleIndex'
      sensorTimestamps:
        type: array
        description: The sensor timestamps to backup
